<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Lomse library. API documentation: Introduction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="lomse.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_100x195.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Lomse library. API documentation
   &#160;<span id="projectnumber">0.17.20</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Overview</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="modules.html"><span>Types&#160;and&#160;constants</span></a></li>
      <li class="current"><a href="pages.html"><span>Other</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('lomse-introduction.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Introduction </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#lomse-philosophy">Lomse philosophy</a></li>
<li class="level1"><a href="#overview-doorway">Class LomseDoorway</a></li>
<li class="level1"><a href="#overview-mvc">The Document and related classes</a></li>
<li class="level1"><a href="#overview-sound-engine">The sound engine</a></li>
<li class="level1"><a href="#overview-rendering-engine">The rendering engine</a></li>
<li class="level1"><a href="#overview-edition">Editing documents</a></li>
<li class="level1"><a href="#rendering-documents"></a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="lomse-philosophy"></a>
Lomse philosophy</h1>
<p>In summary:</p>
<ul>
<li>It is platform independent code, with no knowledge about your platform way of doing things.</li>
<li>Its aim is to provide the services and to delegate in your application for building the presentation / interaction layer.</li>
</ul>
<p>Lomse has no knowledge about your platform native components, windows, or ways of doing things, such as how to produce sounds. Therefore, Lomse does not have methods for doing things such as creating windows or printing documents.</p>
<p>Lomse aims at not constraining your application. Lomse provides all the necessary services (i.e. for reading documents, rendering and editing them, and for playing back scores). But the interface with the user (i.e. the window on which the document is going to be rendered, or the sound engine for producing the sounds) must be provided by your application. Your application is responsible for the presentation and interaction layer. You can use Lomse in any context: interactive programs with a GUI, batch scripts for processing music scores, etc.</p>
<p>For understanding Lomse API you should know about a very few important classes and components described in the following sections.</p>
<h1><a class="anchor" id="overview-doorway"></a>
Class LomseDoorway</h1>
<p>It is the access point to the Lomse library. It must be used by your application at two points:</p>
<ol type="1">
<li>Before using the Lomse library it is necessary to initialize it. This means setting up certain options about rendering and event handling.</li>
<li>Later, your application has to use it for:<ul>
<li>Opening and creating Document objects.</li>
<li>Accessing global objects and variables in Lomse library.</li>
</ul>
</li>
</ol>
<p>See description and usage in documentation for class <a class="el" href="classLomseDoorway.html">LomseDoorway</a>.</p>
<h1><a class="anchor" id="overview-mvc"></a>
The Document and related classes</h1>
<p>Class Document represents a document with any kind of content: music scores, texts, paragraphs, images, tables, lists, etc. Documents are created by invoking <a class="el" href="classLomseDoorway.html#a1b00546f591c2041df5ed86ea0681948">LomseDoorway::new_document()</a> and <a class="el" href="classLomseDoorway.html#a5bb03ca7f58b797ce095354457e9070e">LomseDoorway::open_document()</a> methods.</p>
<p>When a Document is created, additional objects for marshaling the actions between your application and the Document are created. These additional objects are part of the Lomse Model-View-Controller (MVC) architecture. The main objects associated to a Document are:</p>
<ul>
<li>The <em><a class="el" href="classInteractor.html">Interactor</a></em>: It is the interface for interacting with the Document. You can consider it as the controller in the MVC model.</li>
<li>The <em>View</em>: It is an observer of the Document, and its main responsibility is to render it. The rendering type depends on the specific view class used. For instance, class <em>GraphicView</em> renders the document on a bitmap. Other classes would be possible (i.e. a view class to render the document as an SVG stream, a view for rendering as Braille code, a view for rendering as source code, etc.) but currently Lomse only has implemented several variations of <em>GraphicView</em> (<em>VerticalBookView</em>, <em>HorizontalBookView</em>, and <em>SimpleView</em> ). The Lomse MVC model supports having many simultaneous views for a document. The <em><a class="el" href="classInteractor.html">Interactor</a></em> is the owner of the <em>View</em>, and there is an <em><a class="el" href="classInteractor.html">Interactor</a></em> per <em>View</em>.</li>
<li>The <em><a class="el" href="classPresenter.html">Presenter</a></em> - It is the owner of the Document and of all its <em><a class="el" href="classInteractor.html">Interactor</a></em> objects. The <em><a class="el" href="classPresenter.html">Presenter</a></em>'s main responsibility is to build (and delete) the MVC model for a Document.</li>
</ul>
<p>All these issues are described in <a class="el" href="mvc-model.html">Rendering and interacting with documents</a>.</p>
<h1><a class="anchor" id="overview-sound-engine"></a>
The sound engine</h1>
<p>Lomse is platform independent code and cannot generate sounds for your specific platform. Therefore, lomse implements playback by generating real-time events and sending them to your application. It is responsibility of your application to handle these events and do whatever is needed, i.e. transform sound events into real sounds or doing whatever you would like with the sound events.</p>
<p>The details and classes you have to use for scores playback are described in <a class="el" href="sound_generation.html">Scores playback</a>.</p>
<h1><a class="anchor" id="overview-rendering-engine"></a>
The rendering engine</h1>
<p>It is responsible for transforming the information contained in the Document into a bitmap (or other format) for displaying it on the screen.</p>
<h1><a class="anchor" id="overview-edition"></a>
Editing documents</h1>
<p>The <em>InternalModel</em> is a collection of 'internal model objects' (Imo objects) that form a purpose independent representation of the document content. From it, any other specific representation can be derived.</p>
<p>For displaying a document, two steps are performed:</p>
<ol type="1">
<li>The <em>InternalModel</em> is traversed and a <em>GraphicModel</em> is built. It is a collection of <em>GmoBox</em> and <em>GmoShape</em> objects.</li>
<li>The <em>GraphicModel</em> is traversed and its objects rendered to create a bitmap or other desired representation.</li>
</ol>
<p>Involved objects:</p>
<ul>
<li>Boxes and Shapes (<em>GmoBox</em> and <em>GmoShape</em> objects) - They are the 'bricks' that form the <em>GraphicModel</em>.</li>
<li><em>Layouter</em> objects - Its main responsibility is to organise the space, creating areas for placing content. In practice, this implies that layouters main objective is to create the <em>GmoBox</em> objects.</li>
<li><em>Engraver</em> objects - Its main responsibility is to create the symbols (lines, texts, music symbols, etc.) within the specified areas. In practice, this implies that their main objective is to create the <em>GmoShape</em> objects.</li>
<li><em>Drawer</em> - The objects that form the <em>GraphicModel</em>, that is <em>GmoBox</em> and <em>GmoShape</em> objects, are responsible for rendering themselves by issuing drawing commands. The <em>Drawer</em> object is responsible for transforming these commands into something understandable by the underlying rendering engine. Currently only <em>ScreenDrawer</em> class is implemented and it behaves as a vertex source for <em>ScreenRenderer</em> class. But other derived classes would be possible, for instance to generate SVG commands.</li>
<li><em>Calligrapher</em> - It is a helper class specialized in managing fonts and drawing texts.</li>
<li><em>Renderer</em> - It is the front-end object for the desired rendering pipeline. For instance, class <em>ScreenRenderer</em> transforms vertices and paths received from <em>ScreenDrawer</em> into a bitmap.</li>
</ul>
<p>The result of this process is the creation of a bitmap (or other desired output) for displaying the document content.</p>
<p>All these issues are described in render-root.</p>
<h1><a class="anchor" id="rendering-documents"></a>
rendering-documents</h1>
<p>Lomse works by rendering the scores on a bitmap buffer, that is, on an array of consecutive memory bytes. As this buffer is provided by the user application, it can be any type of memory, such as a real bitmap, a window's buffer, etc. This implies that before using Lomse you should decide what is the best approach for using Lomse in your application.</p>
<p>The simplest and usual way of rendering scores on a window is just passing Lomse a bitmap in memory, asking Lomse to render on that bitmap, and copying the bitmap onto the window. And this is the approach we will follow for our wxWidgets application.</p>
<p>To render a bitmap in wxWidgets we usually would use a wxBitmap and do something as:</p>
<pre class="code">
wxMemoryDC memoryDC;
wxBitmap* pBitmap;
memoryDC.SelectObject(*pBitmap);
dc.Blit(0, 0, width, height, &amp;memoryDC, 0, 0);
</pre><p>But Lomse knows nothing about wxBitmap objects. For Lomse, a bitmap is just an array of bytes containing the image pixels, whereas wxBitmap is a platform dependent class containing a buffer for pixels (in a platform dependent format) and additional data.</p>
<p>We could think on using a native Lomse bitmap and building later a wxBitmap object from it. This solution is complex, puts the work on the user application and also requires platform dependent code. Moreover, it requires internal knowledge about wxBitmap format.</p>
<p>So the best approach I've found for using Lomse in wxWidgets applications is to use an wxImage object. First, wxImage is a platform independent class. Therefore, with this choice, we keep our application free of a lot of conditional compilation statements for supporting different platforms. Second, wxImage contains an internal buffer for the image. It is documented and publicly accessible. It is an array of characters in RGBRGBRGB... format, arranged in top-to-bottom, left-to-right order. That is, the first RGB triplet corresponds to the first pixel of the first row; the second RGB triplet corresponds to the second pixel of the first row, and so on until the end of the first row, with second row following after it and so on. In summary, wxImage contains a buffer for a bitmap in RGB, 24 bits format. Luckily, this is one of the bitmap formats supported by Lomse. And, as a bonus, wxImage can be easily converted to an wxBitmap and, therefore, it can be rendered by your application.</p>
<p>So, once we've learn that Lomse renders on bitmaps and once we have found a solution for communicating wxWidgets with Lomse, let's start with our application. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">Overview</a></li>
    <li class="footer">Generated on Fri Mar 25 2016 16:07:21 for Lomse library. API documentation by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
