<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Lomse library. API documentation: Lomse at glance</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="lomse.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_100x195.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Lomse library. API documentation
   &#160;<span id="projectnumber">0.17.20</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Overview</span></a></li>
      <li class="current"><a href="pages.html"><span>Topics</span></a></li>
      <li><a href="modules.html"><span>Types&#160;and&#160;constants</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('lomse-overview.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Lomse at glance </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#lomse-main-components">Lomse main components</a></li>
<li class="level1"><a href="#overview-building-documents">Building the document</a></li>
<li class="level1"><a href="#overview-rendering-documents">Rendering the document</a></li>
<li class="level1"><a href="#overview-user-interaction">Presentation and user interaction</a></li>
<li class="level1"><a href="#overview-sound-generation">Playing back scores</a></li>
<li class="level1"><a href="#overview-other-issues">Other issues</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="lomse-main-components"></a>
Lomse main components</h1>
<p>The Lomse's main components are:</p>
<ul>
<li>The <em>Document</em> - Lomse library main class is <em>Document`. It represents a document of any of the supported types:<ul>
<li>MusicXML music scores</li>
<li>LenMus documents. You can see LenMus documents as something similar to HTML documents but with the ability of also including music scores. All other important classes are built around the <em>Document</em>, either for displaying it or for building/modifying its content.</li>
</ul>
</em></li>
<li><em>The rendering engine - It is responsible for transforming the information contained in the <em>Document</em> into a bitmap (or other format) for displaying it on the screen.</em></li>
<li><em>The MVC model - For marshaling the actions between your application, the <em>Document</em> and the rendering engine, Lomse uses a Model-View-Controller (MVC) architecture. Multiple simultaneous views of the document are supported.</em></li>
<li><em>The sound engine - It is responsible for transforming the information contained in the <em>Document</em> into a stream of events for generating sound and graphical feedback (notes highlight, moving tempo line)</em></li>
<li><em>Class <em><a class="el" href="classLomseDoorway.html">LomseDoorway</a></em> - It is the access point to the Lomse library. It must be used by your application at two points:<ol type="1">
<li>Before using the Lomse library it is necessary to initialize it. This means setting up certain options about rendering and event handling.</li>
<li>Later, your application has to use <em><a class="el" href="classLomseDoorway.html">LomseDoorway</a></em> for requesting to create <em>Document</em> objects.</li>
</ol>
</em></li>
</ul>
<p><em></em></p>
<h1><a class="anchor" id="overview-building-documents"></a>
Building the document</h1>
<p><em> The main content of a <em>Document</em> is the <em>InternalModel`. It is something similar to the DOM in HTML. By accessing and modifying this internal model you have full control over the document content.</em></em></p>
<p><em><em>A <em>Document</em> can be created:</em></em></p>
<p><em><em></p>
<ul>
<li>From a file containing the document source code (LDP language)</li>
<li>From a string, also containing LDP source code.</li>
<li>Or, dynamically, by program.</li>
</ul>
<p></em></em></p>
<p><em><em>The LDP compiler follows a typical structure. A tokenizer class <em>LdpTokenizer</em> is responsible for the lexical analysis, grouping the input into language tokens. The <em>LdpParser</em> class does the syntactical analysis, and produces a parse tree. Then the <em>Analyser</em> class is responsible for syntax validation and semantic analysis; it adds information to the parse tree. Finally, the <em>ModelBuilder</em> class performs the code generation phase.</em></em></p>
<p><em><em>The <em>Document</em> can also be created and modified by program. Commands on the <em>Document</em> and direct manipulation of the <em>InternalModel</em> give full flexibility for this. An special LDP tag *dynamic- instructs the <em>Analyser</em> to require from user application the content to be inserted at that point. This is something analogous to the HTML &lt;object&gt; tag.</em></em></p>
<p><em><em>All these issues are described in document-root.</em></em></p>
<p><em><em></em></em></p>
<h1><a class="anchor" id="overview-rendering-documents"></a>
Rendering the document</h1>
<p><em><em> The <em>InternalModel</em> is a collection of 'internal model objects' (Imo objects) that form a purpose independent representation of the document content. From it, any other specific representation can be derived.</em></em></p>
<p><em><em>For displaying a document, two steps are performed:</em></em></p>
<p><em><em></p>
<ol type="1">
<li>The <em>InternalModel</em> is traversed and a <em>GraphicModel</em> is built. It is a collection of <em>GmoBox</em> and <em>GmoShape</em> objects.</li>
<li>The <em>GraphicModel</em> is traversed and its objects rendered to create a bitmap or other desired representation.</li>
</ol>
<p></em></em></p>
<p><em><em>Involved objects:</em></em></p>
<p><em><em></p>
<ul>
<li>Boxes and Shapes (<em>GmoBox</em> and <em>GmoShape</em> objects) - They are the 'bricks' that form the <em>GraphicModel`.</em></li>
<li><em><em>Layouter</em> objects - Its main responsibility is to organise the space, creating areas for placing content. In practice, this implies that layouters main objective is to create the <em>GmoBox</em> objects.</em></li>
<li><em><em>Engraver</em> objects - Its main responsibility is to create the symbols (lines, texts, music symbols, etc.) within the specified areas. In practice, this implies that their main objective is to create the <em>GmoShape</em> objects.</em></li>
<li><em><em>Drawer</em> - The objects that form the <em>GraphicModel</em>, that is <em>GmoBox</em> and <em>GmoShape</em> objects, are responsible for rendering themselves by issuing drawing commands. The <em>Drawer</em> object is responsible for transforming these commands into something understandable by the underlying rendering engine. Currently only <em>ScreenDrawer</em> class is implemented and it behaves as a vertex source for <em>ScreenRenderer</em> class. But other derived classes would be possible, for instance to generate SVG commands.</em></li>
<li><em><em>Calligrapher</em> - It is a helper class specialized in managing fonts and drawing texts.</em></li>
<li><em><em>Renderer</em> - It is the front-end object for the desired rendering pipeline. For instance, class <em>ScreenRenderer</em> transforms vertices and paths received from <em>ScreenDrawer</em> into a bitmap.</em></li>
</ul>
<p></em></em></p>
<p><em><em><em>The result of this process is the creation of a bitmap (or other desired output) for displaying the document content.</em></em></em></p>
<p><em><em><em>All these issues are described in render-root.</em></em></em></p>
<p><em><em><em></em></em></em></p>
<h1><a class="anchor" id="overview-user-interaction"></a>
Presentation and user interaction</h1>
<p><em><em><em> The Lomse MVC architecture is composed by several objects. The main ones are:</em></em></em></p>
<p><em><em><em></p>
<ul>
<li>The <em>View</em> - It is an observer of the <code>Document&lt;/i&gt;, and its main responsibility is to render it. The rendering type depends on the specific view class used. For instance, class &lt;i&gt;GraphicView&lt;/i&gt; renders the document on a bitmap. Other classes would be possible (i.e. a view class to render the document as an SVG stream) but for now I have only implemented several variations of &lt;i&gt;GraphicView&lt;/i&gt; (&lt;/i&gt; VerticalBookView&lt;/i&gt;, &lt;i&gt;HorizontalBookView&lt;/i&gt;, and &lt;i&gt;SimpleView&lt;/i&gt; ). The model supports having many simultaneous views for a document.</code></li>
<li><code>The &lt;i&gt;Interactor&lt;/i&gt; - It is a facade object and its main responsibility is to transform user application actions into commands on the document and the MVC model. Therefore, you can consider it as the controller in the MVC model. The &lt;i&gt;Interactor&lt;/i&gt; is the owner of the &lt;i&gt;View&lt;/i&gt;, and there is an &lt;i&gt;Interactor&lt;/i&gt; per &lt;i&gt;View</code>.</li>
<li>The <em>Presenter</em> - It is the owner of the <code>Document</code> and of all its <em>Interactor</em> objects. The <em>Presenter</em> 's main responsibility is to build (and delete) the MVC model for a <em>Document`.</em></li>
</ul>
<p></em></em></em></p>
<p><em><em><em><em>All these issues are described in mvc-root.</em></em></em></em></p>
<p><em><em><em><em></em></em></em></em></p>
<h1><a class="anchor" id="overview-sound-generation"></a>
Playing back scores</h1>
<p><em><em><em><em> As said, the <em>InternalModel</em> is a collection of 'internal model objects' (Imo objects), that form an purpose independent representation of the document content. From it, any other specific purpose representation can be derived.</em></em></em></em></p>
<p><em><em><em><em>For playing back scores, two steps are performed:</em></em></em></em></p>
<p><em><em><em><em></p>
<ul>
<li>The <em>InternalModel</em> is parsed to build the sound model</li>
<li>The sound model is traversed and two kind of events are generated:<ol type="1">
<li>Sound events, for generating sounds</li>
<li>Highlight events, for adding visual effects to the displayed score (notes highlight, moving tempo line, ...).</li>
</ol>
</li>
</ul>
<p></em></em></em></em></p>
<p><em><em><em><em>Involved objects:</em></em></em></em></p>
<p><em><em><em><em></p>
<ul>
<li><em>SoundPlayer</em></li>
<li><em>SoundEventsTable</em></li>
</ul>
<p></em></em></em></em></p>
<p><em><em><em><em>All these issues are described in sound-root.</em></em></em></em></p>
<p><em><em><em><em></em></em></em></em></p>
<h1><a class="anchor" id="overview-other-issues"></a>
Other issues</h1>
<p><em><em><em><em> For orchestrating all these pieces some issues have to be taken into account. Therefore, some additional important objects were created. For instance, I already introduced the <em><a class="el" href="classLomseDoorway.html">LomseDoorway</a></em>, whose main responsibility is allowing user application to initialize the library and for requesting to create <em>Document</em> objects.</em></em></em></em></p>
<p><em><em><em><em>All these additional issues are described in other-root. </em></em></em></em></p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">Overview</a></li>
    <li class="footer">Generated on Mon Mar 14 2016 15:10:30 for Lomse library. API documentation by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
